<!DOCTYPE html>
<html>

<head>
    <title>Lender Panel</title>
</head>

<body>
    <h2>Lender Preferences API</h2>
    <form id="prefForm">
        Total Lending Amount: <input type="number" name="total_lending_amount" required><br>
        Time Period (Months): <input type="number" name="time_period_months" required><br>
        Risk Appetite: <select name="risk_appetite">
            <option value="Low">Low</option>
            <option value="Medium">Medium</option>
            <option value="High">High</option>
        </select><br>
        Withdrawal Preference: <select name="withdrawal_preference">
            <option value="Monthly Interest">Monthly Interest</option>
            <option value="End of Term">End of Term</option>
            <option value="Manual">Manual</option>
        </select><br>
        Auto Reinvest: <input type="checkbox" name="auto_reinvest" value="true"><br>
        <button type="submit">Submit Preferences POST</button>
    </form>
    <div id="result"></div>
    <br><a href="/home/">Go to Home</a>
    <script>
        const token = localStorage.getItem('token');
        if (!token) window.location.href = '/login/';

        document.getElementById('prefForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const data = Object.fromEntries(new FormData(e.target).entries());
            data.auto_reinvest = !!e.target.auto_reinvest.checked;
            document.getElementById('result').innerText = "Loading...";

            const res = await fetch('/api/lender-preferences/', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json', 'Authorization': `Token ${token}` },
                body: JSON.stringify(data)
            });
            const json = await res.json();
            document.getElementById('result').innerHTML = "<pre>" + JSON.stringify(json, null, 2) + "</pre>";
        });
    </script>
</body>

</html>